Ì
cC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Controllers\JobController.cs
	namespace 	
	Challenge
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
JobController 
:  
ControllerBase! /
{ 
private 
readonly 
IShowService %
_showService& 2
;2 3
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
public 
JobController 
( 
IShowService )
showService* 5
,5 6
IConfiguration7 E
configurationF S
)S T
{ 	
_showService 
= 
showService &
;& '
_configuration 
= 
configuration *
;* +
} 	
[ 	
HttpPost	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
RunJob) /
(/ 0
[0 1

FromHeader1 ;
(; <
Name< @
=A B
$strC N
)N O
]O P
stringQ W
apiKeyX ^
)^ _
{ 	
var 
configuredApiKey  
=! "
_configuration# 1
[1 2
$str2 :
]: ;
;; <
if 
( 
apiKey 
!= 
configuredApiKey *
)* +
{ 
return 
Unauthorized #
(# $
$str$ 6
)6 7
;7 8
} 
try 
{   
await!! 
_showService!! "
.!!" ##
FetchAndStoreShowsAsync!!# :
(!!: ;
)!!; <
;!!< =
return"" 
Ok"" 
("" 
$str"" 6
)""6 7
;""7 8
}## 
catch$$ 
($$ 
	Exception$$ 
ex$$ 
)$$  
{%% 
return'' 

StatusCode'' !
(''! "
$num''" %
,''% &
$str''' S
)''S T
;''T U
}(( 
})) 	
}** 
}++ ∑.
eC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Controllers\ShowsController.cs
	namespace 	
	Challenge
 
. 
Controllers 
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class 
ShowsController  
:! "
ControllerBase# 1
{ 
private 
readonly 
IShowService %
_showService& 2
;2 3
public 
ShowsController 
( 
IShowService +
showService, 7
)7 8
{ 	
_showService 
= 
showService &
;& '
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Show3 7
>7 8
>8 9
>9 :
GetAllShows; F
(F G
)G H
{ 	
var 
shows 
= 
await 
_showService *
.* +
GetAllShowsAsync+ ;
(; <
)< =
;= >
return 
Ok 
( 
shows 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
ActionResult &
<& '
Show' +
>+ ,
>, -
GetShowById. 9
(9 :
int: =
id> @
)@ A
{ 	
var   
show   
=   
await   
_showService   )
.  ) *
GetShowByIdAsync  * :
(  : ;
id  ; =
)  = >
;  > ?
if"" 
("" 
show"" 
=="" 
null"" 
)"" 
{## 
return$$ 
NotFound$$ 
($$  
)$$  !
;$$! "
}%% 
return'' 
Ok'' 
('' 
show'' 
)'' 
;'' 
}(( 	
[++ 	
HttpPost++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
ActionResult,, &
<,,& '
Show,,' +
>,,+ ,
>,,, -

CreateShow,,. 8
(,,8 9
[,,9 :
FromBody,,: B
],,B C
Show,,D H
show,,I M
),,M N
{-- 	
if.. 
(.. 
show.. 
==.. 
null.. 
).. 
{// 
return00 

BadRequest00 !
(00! "
$str00" 8
)008 9
;009 :
}11 
await33 
_showService33 
.33 
AddShowAsync33 +
(33+ ,
show33, 0
)330 1
;331 2
return44 
CreatedAtAction44 "
(44" #
nameof44# )
(44) *
GetShowById44* 5
)445 6
,446 7
new448 ;
{44< =
id44> @
=44A B
show44C G
.44G H
Id44H J
}44K L
,44L M
show44N R
)44R S
;44S T
}55 	
[88 	
HttpPut88	 
(88 
$str88 
)88 
]88 
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (

UpdateShow99) 3
(993 4
int994 7
id998 :
,99: ;
[99< =
FromBody99= E
]99E F
Show99G K
show99L P
)99P Q
{:: 	
if;; 
(;; 
show;; 
==;; 
null;; 
||;; 
id;;  "
!=;;# %
show;;& *
.;;* +
Id;;+ -
);;- .
{<< 
return== 

BadRequest== !
(==! "
$str==" 9
)==9 :
;==: ;
}>> 
var@@ 
existingShow@@ 
=@@ 
await@@ $
_showService@@% 1
.@@1 2
GetShowByIdAsync@@2 B
(@@B C
id@@C E
)@@E F
;@@F G
ifBB 
(BB 
existingShowBB 
==BB 
nullBB  $
)BB$ %
{CC 
returnDD 
NotFoundDD 
(DD  
)DD  !
;DD! "
}EE 
awaitGG 
_showServiceGG 
.GG 
UpdateShowAsyncGG .
(GG. /
showGG/ 3
)GG3 4
;GG4 5
returnHH 
	NoContentHH 
(HH 
)HH 
;HH 
}II 	
[LL 	

HttpDeleteLL	 
(LL 
$strLL 
)LL 
]LL 
publicMM 
asyncMM 
TaskMM 
<MM 
IActionResultMM '
>MM' (

DeleteShowMM) 3
(MM3 4
intMM4 7
idMM8 :
)MM: ;
{NN 	
varOO 
existingShowOO 
=OO 
awaitOO $
_showServiceOO% 1
.OO1 2
GetShowByIdAsyncOO2 B
(OOB C
idOOC E
)OOE F
;OOF G
ifQQ 
(QQ 
existingShowQQ 
==QQ 
nullQQ  $
)QQ$ %
{RR 
returnSS 
NotFoundSS 
(SS  
)SS  !
;SS! "
}TT 
awaitVV 
_showServiceVV 
.VV 
DeleteShowAsyncVV .
(VV. /
idVV/ 1
)VV1 2
;VV2 3
returnWW 
	NoContentWW 
(WW 
)WW 
;WW 
}XX 	
}YY 
}ZZ ®M
cC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Data\ApplicationDbContext.cs
	namespace 	
	Challenge
 
. 
Data 
{ 
public 

class  
ApplicationDbContext %
:& '
	DbContext( 1
{ 
public  
ApplicationDbContext #
(# $
DbContextOptions$ 4
<4 5 
ApplicationDbContext5 I
>I J
optionsK R
)R S
:		 
base		 
(		 
options		 
)		 
{

 	
} 	
public 
DbSet 
< 
Show 
> 
Shows  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Network 
> 
Networks &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Country 
> 
	Countries '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
public 
DbSet 
< 
	Externals 
> 
	Externals  )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 
DbSet 
< 
Genre 
> 
Genres "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
Rating 
> 
Ratings $
{% &
get' *
;* +
set, /
;/ 0
}1 2
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
Country  '
>' (
(( )
)) *
. 
HasKey 
( 
c 
=> 
c 
. 
Code #
)# $
;$ %
modelBuilder 
. 
Entity 
<  
Country  '
>' (
(( )
)) *
. 
Property 
( 
c 
=> 
c  
.  !
Code! %
)% &
. 
ValueGeneratedNever $
($ %
)% &
;& '
modelBuilder 
. 
Entity 
<  
Network  '
>' (
(( )
)) *
.   
HasKey   
(   
n   
=>   
n   
.   
Id   !
)  ! "
;  " #
modelBuilder!! 
.!! 
Entity!! 
<!!  
Network!!  '
>!!' (
(!!( )
)!!) *
."" 
Property"" 
("" 
n"" 
=>"" 
n""  
.""  !
Id""! #
)""# $
.## 
ValueGeneratedNever## $
(##$ %
)##% &
;##& '
modelBuilder$$ 
.$$ 
Entity$$ 
<$$  
Network$$  '
>$$' (
($$( )
)$$) *
.%% 
HasOne%% 
(%% 
n%% 
=>%% 
n%% 
.%% 
Country%% &
)%%& '
.&& 
WithMany&& 
(&& 
)&& 
.'' 
HasForeignKey'' 
('' 
n''  
=>''! #
n''$ %
.''% &
CountryCode''& 1
)''1 2
.(( 
OnDelete(( 
((( 
DeleteBehavior(( (
.((( )
Restrict(() 1
)((1 2
;((2 3
modelBuilder++ 
.++ 
Entity++ 
<++  
Network++  '
>++' (
(++( )
)++) *
.,, 
HasMany,, 
(,, 
n,, 
=>,, 
n,, 
.,,  
Shows,,  %
),,% &
.-- 
WithOne-- 
(-- 
s-- 
=>-- 
s-- 
.--  
Network--  '
)--' (
... 
HasForeignKey.. 
(.. 
s..  
=>..! #
s..$ %
...% &
	NetworkId..& /
)../ 0
.// 
OnDelete// 
(// 
DeleteBehavior// (
.//( )
Restrict//) 1
)//1 2
;//2 3
modelBuilder22 
.22 
Entity22 
<22  
Show22  $
>22$ %
(22% &
)22& '
.33 
HasKey33 
(33 
s33 
=>33 
s33 
.33 
Id33 !
)33! "
;33" #
modelBuilder44 
.44 
Entity44 
<44  
Show44  $
>44$ %
(44% &
)44& '
.55 
Property55 
(55 
s55 
=>55 
s55  
.55  !
Id55! #
)55# $
.66 
ValueGeneratedNever66 $
(66$ %
)66% &
;66& '
modelBuilder99 
.99 
Entity99 
<99  
	Externals99  )
>99) *
(99* +
)99+ ,
.:: 
HasKey:: 
(:: 
e:: 
=>:: 
e:: 
.:: 
Id:: !
)::! "
;::" #
modelBuilder;; 
.;; 
Entity;; 
<;;  
	Externals;;  )
>;;) *
(;;* +
);;+ ,
.<< 
Property<< 
(<< 
e<< 
=><< 
e<<  
.<<  !
Id<<! #
)<<# $
.== 
ValueGeneratedNever== $
(==$ %
)==% &
;==& '
modelBuilder>> 
.>> 
Entity>> 
<>>  
	Externals>>  )
>>>) *
(>>* +
)>>+ ,
.?? 
Property?? 
(?? 
e?? 
=>?? 
e??  
.??  !
Imdb??! %
)??% &
.@@ 

IsRequired@@ 
(@@ 
false@@ !
)@@! "
;@@" #
modelBuilderAA 
.AA 
EntityAA 
<AA  
	ExternalsAA  )
>AA) *
(AA* +
)AA+ ,
.BB 
HasOneBB 
(BB 
eBB 
=>BB 
eBB 
.BB 
ShowBB #
)BB# $
.CC 
WithOneCC 
(CC 
sCC 
=>CC 
sCC 
.CC  
	ExternalsCC  )
)CC) *
.DD 
HasForeignKeyDD 
<DD 
	ExternalsDD (
>DD( )
(DD) *
eDD* +
=>DD, .
eDD/ 0
.DD0 1
IdDD1 3
)DD3 4
;DD4 5
modelBuilderGG 
.GG 
EntityGG 
<GG  
RatingGG  &
>GG& '
(GG' (
)GG( )
.HH 
HasKeyHH 
(HH 
rHH 
=>HH 
rHH 
.HH 
IdHH !
)HH! "
;HH" #
modelBuilderII 
.II 
EntityII 
<II  
RatingII  &
>II& '
(II' (
)II( )
.JJ 
PropertyJJ 
(JJ 
rJJ 
=>JJ 
rJJ  
.JJ  !
IdJJ! #
)JJ# $
.KK 
ValueGeneratedNeverKK $
(KK$ %
)KK% &
;KK& '
modelBuilderLL 
.LL 
EntityLL 
<LL  
RatingLL  &
>LL& '
(LL' (
)LL( )
.MM 
HasOneMM 
(MM 
rMM 
=>MM 
rMM 
.MM 
ShowMM #
)MM# $
.NN 
WithOneNN 
(NN 
sNN 
=>NN 
sNN 
.NN  
RatingNN  &
)NN& '
.OO 
HasForeignKeyOO 
<OO 
RatingOO %
>OO% &
(OO& '
rOO' (
=>OO) +
rOO, -
.OO- .
IdOO. 0
)OO0 1
;OO1 2
modelBuilderRR 
.RR 
EntityRR 
<RR  
GenreRR  %
>RR% &
(RR& '
)RR' (
.SS 
HasKeySS 
(SS 
gSS 
=>SS 
gSS 
.SS 
IdSS !
)SS! "
;SS" #
modelBuilderTT 
.TT 
EntityTT 
<TT  
GenreTT  %
>TT% &
(TT& '
)TT' (
.UU 
PropertyUU 
(UU 
gUU 
=>UU 
gUU  
.UU  !
IdUU! #
)UU# $
.VV 
ValueGeneratedOnAddVV $
(VV$ %
)VV% &
;VV& '
modelBuilderYY 
.YY 
EntityYY 
<YY  
ShowYY  $
>YY$ %
(YY% &
)YY& '
.ZZ 
HasManyZZ 
(ZZ 
sZZ 
=>ZZ 
sZZ 
.ZZ  
GenresZZ  &
)ZZ& '
.[[ 
WithMany[[ 
([[ 
g[[ 
=>[[ 
g[[  
.[[  !
Shows[[! &
)[[& '
.\\ 
UsingEntity\\ 
(\\ 
j\\ 
=>\\ !
j\\" #
.\\# $
ToTable\\$ +
(\\+ ,
$str\\, 8
)\\8 9
)\\9 :
;\\: ;
}]] 	
}^^ 
}__ ¨

XC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\CountryDTO.cs
	namespace 	
	Challenge
 
. 
DTO 
{ 
public 

class 

CountryDto 
{ 
[ 	
JsonPropertyName	 
( 
$str 
) 
]  
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[

 	
JsonPropertyName

	 
(

 
$str

  
)

  !
]

! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Code 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str $
)$ %
]% &
public 
string 
Timezone 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}  
ZC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\ExternalsDTO.cs
	namespace 	
	Challenge
 
. 
DTO 
{ 
public 

class 
ExternalsDto 
{ 
[ 	
JsonPropertyName	 
( 
$str "
)" #
]# $
public 
int 
? 
Tvrage 
{ 
get  
;  !
set" %
;% &
}' (
[

 	
JsonPropertyName

	 
(

 
$str

 #
)

# $
]

$ %
public 
int 
? 
Thetvdb 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Imdb 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ±
VC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\GenreDTO.cs
	namespace 	
	Challenge
 
. 
DTO 
{ 
public 

class 
GenreDTO 
{		 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ´
XC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\NetworkDTO.cs
	namespace 	
	Challenge
 
. 
DTO 
{ 
public 

class 

NetworkDto 
{ 
[ 	
JsonPropertyName	 
( 
$str 
) 
]  
public		 
int		 
Id		 
{		 
get		 
;		 
set		  
;		  !
}		" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str #
)# $
]$ %
public 

CountryDto 
Country !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ±
WC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\RatingDTO.cs
	namespace 	
	Challenge
 
. 
DTO 
{ 
public 

class 
	RatingDto 
{ 
[ 	
JsonPropertyName	 
( 
$str #
)# $
]$ %
public 
double 
? 
Average 
{  
get! $
;$ %
set& )
;) *
}+ ,
}		 
}

 ¸
UC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\DTO\ShowDTO.cs
	namespace 	
	Challenge
 
. 
DTOs 
{ 
public 

class 
ShowDto 
{ 
[		 	
JsonPropertyName			 
(		 
$str		 
)		 
]		  
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str $
)$ %
]% &
public 
string 
Language 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
JsonPropertyName	 
( 
$str "
)" #
]# $
public 
List 
< 
string 
> 
Genres "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
JsonPropertyName	 
( 
$str %
)% &
]& '
public 
ExternalsDto 
	Externals %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
JsonPropertyName	 
( 
$str #
)# $
]$ %
public 

NetworkDto 
Network !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
JsonPropertyName	 
( 
$str "
)" #
]# $
public 
	RatingDto 
Rating 
{  !
get" %
;% &
set' *
;* +
}, -
} 
}   ê
XC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Country.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public 

class 
Country 
{ 
[		 	
Key			 
]		 
[

 	
DatabaseGenerated

	 
(

 #
DatabaseGeneratedOption

 2
.

2 3
None

3 7
)

7 8
]

8 9
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str $
)$ %
]% &
public 
string 
Timezone 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Code 
{ 
get  
;  !
set" %
;% &
}' (
} 
} Ó
ZC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Externals.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public 

class 
	Externals 
{		 
[

 	
Key

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
None3 7
)7 8
]8 9
[ 	

ForeignKey	 
( 
$str 
) 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
? 
Imdb 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
JsonPropertyName	 
( 
$str "
)" #
]# $
public 
int 
? 
Tvrage 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str #
)# $
]$ %
public 
int 
? 
Thetvdb 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

JsonIgnore	 
] 
public 
Show 
Show 
{ 
get 
; 
set  #
;# $
}% &
} 
} ó

VC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Genre.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public 

class 
Genre 
{		 
[

 	
Key

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	

JsonIgnore	 
] 
public 
ICollection 
< 
Show 
>  
Shows! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Show@ D
>D E
(E F
)F G
;G H
} 
} «
XC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Network.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public 

class 
Network 
{		 
[

 	
Key

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
None3 7
)7 8
]8 9
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

ForeignKey	 
( 
$str 
) 
] 
public 
string 
CountryCode !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
Country 
Country 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	

JsonIgnore	 
] 
public 
ICollection 
< 
Show 
>  
Shows! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Show@ D
>D E
(E F
)F G
;G H
} 
} ∆	
WC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Rating.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public 

class 
Rating 
{		 
[

 	
Key

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
None3 7
)7 8
]8 9
[ 	

ForeignKey	 
( 
$str 
) 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str #
)# $
]$ %
public 
double 
? 
Average 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	

JsonIgnore	 
] 
public 
Show 
Show 
{ 
get 
; 
set  #
;# $
}% &
} 
} Ù
UC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Models\Show.cs
	namespace 	
	Challenge
 
. 
Models 
{ 
public		 

class		 
Show		 
{

 
[ 	
Key	 
] 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
None3 7
)7 8
]8 9
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
JsonPropertyName	 
( 
$str  
)  !
]! "
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
JsonPropertyName	 
( 
$str $
)$ %
]% &
public 
string 
? 
Language 
{  !
get" %
;% &
set' *
;* +
}, -
public 
int 
? 
	NetworkId 
{ 
get  #
;# $
set% (
;( )
}* +
public 
Network 
Network 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
	Externals 
	Externals "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
Rating 
Rating 
{ 
get "
;" #
set$ '
;' (
}) *
public 
ICollection 
< 
Genre  
>  !
Genres" (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
=7 8
new9 <
List= A
<A B
GenreB G
>G H
(H I
)I J
;J K
} 
} ˘!
QC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Program.cs
[ 
assembly 	
:	 

InternalsVisibleTo 
( 
$str /
)/ 0
]0 1
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
Program 
. 
ConfigureDatabase 
( 
builder !
.! "
Services" *
,* +
builder, 3
.3 4
Configuration4 A
)A B
;B C
builder 
. 
Services 
. 
	AddScoped 
< 
IShowService '
,' (
ShowService) 4
>4 5
(5 6
)6 7
;7 8
builder 
. 
Services 
. 
	AddScoped 
< 
IShowRepository *
,* +
ShowRepository, :
>: ;
(; <
)< =
;= >
builder 
. 
Services 
. 
AddHttpClient 
( 
)  
;  !
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if"" 
("" 
app"" 
."" 
Environment"" 
."" 
IsDevelopment"" !
(""! "
)""" #
||""$ &
app""' *
.""* +
Environment""+ 6
.""6 7
	IsStaging""7 @
(""@ A
)""A B
)""B C
{## 
app$$ 
.$$ 

UseSwagger$$ 
($$ 
)$$ 
;$$ 
app%% 
.%% 
UseSwaggerUI%% 
(%% 
)%% 
;%% 
}&& 
app(( 
.(( 
UseHttpsRedirection(( 
((( 
)(( 
;(( 
app)) 
.)) 
UseAuthorization)) 
()) 
))) 
;)) 
app** 
.** 
MapControllers** 
(** 
)** 
;** 
app,, 
.,, 
Run,, 
(,, 
),, 	
;,,	 

public.. 
partial.. 
class.. 
Program.. 
{// 
public11 

static11 
void11 
ConfigureDatabase11 (
(11( )
IServiceCollection11) ;
services11< D
,11D E
IConfiguration11F T
configuration11U b
)11b c
{22 
services33 
.33 
AddDbContext33 
<33  
ApplicationDbContext33 2
>332 3
(333 4
options334 ;
=>33< >
{44 	
var55 
connectionString55  
=55! "
configuration55# 0
.550 1
GetConnectionString551 D
(55D E
$str55E X
)55X Y
;55Y Z
if66 
(66 
string66 
.66 
IsNullOrEmpty66 $
(66$ %
connectionString66% 5
)665 6
)666 7
{77 
throw88 
new88 %
InvalidOperationException88 3
(883 4
$str884 n
)88n o
;88o p
}99 
options:: 
.:: 
UseSqlServer::  
(::  !
connectionString::! 1
)::1 2
;::2 3
};; 	
);;	 

;;;
 
}<< 
public?? 

void?? 
Dummy?? 
(?? 
)?? 
{@@ 
ConsoleAA 
.AA 
	WriteLineAA 
(AA 
$strAA 4
)AA4 5
;AA5 6
}BB 
}CC ˇ
fC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Repositories\IShowRepository.cs
	namespace 	
	Challenge
 
. 
Repositories  
{ 
public 

	interface 
IShowRepository $
{		 
Task

 
<

 
IEnumerable

 
<

 
Show

 
>

 
>

 
GetAllShowsAsync

  0
(

0 1
)

1 2
;

2 3
Task 
< 
Show 
> 
GetShowByIdAsync #
(# $
int$ '
id( *
)* +
;+ ,
Task 
AddShowAsync 
( 
Show 
show #
)# $
;$ %
void 

UpdateShow 
( 
Show 
show !
)! "
;" #
void 

DeleteShow 
( 
Show 
show !
)! "
;" #
Task 
SaveChangesAsync 
( 
) 
;  
} 
} ˚"
eC:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Repositories\ShowRepository.cs
	namespace		 	
	Challenge		
 
.		 
Repositories		  
{

 
public 

class 
ShowRepository 
:  !
IShowRepository" 1
{ 
private 
readonly  
ApplicationDbContext -
_context. 6
;6 7
public 
ShowRepository 
(  
ApplicationDbContext 2
context3 :
): ;
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
Show& *
>* +
>+ ,
GetAllShowsAsync- =
(= >
)> ?
{ 	
return 
await 
_context !
.! "
Shows" '
. 
AsNoTracking 
( 
) 
. 
Include 
( 
s 
=> 
s 
.  
Genres  &
)& '
. 
Include 
( 
s 
=> 
s 
.  
	Externals  )
)) *
. 
Include 
( 
s 
=> 
s 
.  
Rating  &
)& '
. 
Include 
( 
s 
=> 
s 
.  
Network  '
)' (
. 
ThenInclude  
(  !
n! "
=># %
n& '
.' (
Country( /
)/ 0
. 
ToListAsync 
( 
) 
; 
} 	
public   
async   
Task   
<   
Show   
>   
GetShowByIdAsync    0
(  0 1
int  1 4
id  5 7
)  7 8
{!! 	
return"" 
await"" 
_context"" !
.""! "
Shows""" '
.## 
Include## 
(## 
s## 
=>## 
s## 
.##  
Genres##  &
)##& '
.$$ 
Include$$ 
($$ 
s$$ 
=>$$ 
s$$ 
.$$  
	Externals$$  )
)$$) *
.%% 
Include%% 
(%% 
s%% 
=>%% 
s%% 
.%%  
Rating%%  &
)%%& '
.&& 
Include&& 
(&& 
s&& 
=>&& 
s&& 
.&&  
Network&&  '
)&&' (
.'' 
ThenInclude''  
(''  !
n''! "
=>''# %
n''& '
.''' (
Country''( /
)''/ 0
.(( 
FirstOrDefaultAsync(( $
((($ %
s((% &
=>((' )
s((* +
.((+ ,
Id((, .
==((/ 1
id((2 4
)((4 5
;((5 6
})) 	
public++ 
async++ 
Task++ 
AddShowAsync++ &
(++& '
Show++' +
show++, 0
)++0 1
{,, 	
await-- 
_context-- 
.-- 
Shows--  
.--  !
AddAsync--! )
(--) *
show--* .
)--. /
;--/ 0
}.. 	
public00 
void00 

UpdateShow00 
(00 
Show00 #
show00$ (
)00( )
{11 	
_context22 
.22 
Shows22 
.22 
Update22 !
(22! "
show22" &
)22& '
;22' (
}33 	
public55 
void55 

DeleteShow55 
(55 
Show55 #
show55$ (
)55( )
{66 	
_context77 
.77 
Shows77 
.77 
Remove77 !
(77! "
show77" &
)77& '
;77' (
}88 	
public:: 
async:: 
Task:: 
SaveChangesAsync:: *
(::* +
)::+ ,
{;; 	
await<< 
_context<< 
.<< 
SaveChangesAsync<< +
(<<+ ,
)<<, -
;<<- .
}== 	
}>> 
}?? ˇ
_C:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Services\IShowService.cs
	namespace 	
	Challenge
 
. 
Services 
{ 
public 

	interface 
IShowService !
{ 
Task		 #
FetchAndStoreShowsAsync		 $
(		$ %
)		% &
;		& '
Task

 
<

 
IEnumerable

 
<

 
Show

 
>

 
>

 
GetAllShowsAsync

  0
(

0 1
)

1 2
;

2 3
Task 
< 
Show 
> 
GetShowByIdAsync #
(# $
int$ '
id( *
)* +
;+ ,
Task 
AddShowAsync 
( 
Show 
show #
)# $
;$ %
Task 
UpdateShowAsync 
( 
Show !
show" &
)& '
;' (
Task 
DeleteShowAsync 
( 
int  
id! #
)# $
;$ %
} 
} óâ
^C:\Users\cheva\Downloads\ChallengeFix-main\ChallengeFix-main\Challenge\Services\ShowService.cs
	namespace 	
	Challenge
 
. 
Services 
{ 
public 

class 
ShowService 
: 
IShowService +
{ 
private 
readonly 
IShowRepository (
_showRepository) 8
;8 9
private 
readonly  
ApplicationDbContext -
_context. 6
;6 7
private 
readonly 
IHttpClientFactory +
_httpClientFactory, >
;> ?
private 
readonly 
string 
_apiUrl  '
;' (
public 
ShowService 
( 
IShowRepository 
showRepository *
,* + 
ApplicationDbContext  
context! (
,( )
IHttpClientFactory 
httpClientFactory 0
,0 1
IConfiguration 
configuration (
)( )
{ 	
_showRepository 
= 
showRepository ,
??- /
throw0 5
new6 9!
ArgumentNullException: O
(O P
nameofP V
(V W
showRepositoryW e
)e f
)f g
;g h
_context 
= 
context 
?? !
throw" '
new( +!
ArgumentNullException, A
(A B
nameofB H
(H I
contextI P
)P Q
)Q R
;R S
_httpClientFactory 
=  
httpClientFactory! 2
??3 5
throw6 ;
new< ?!
ArgumentNullException@ U
(U V
nameofV \
(\ ]
httpClientFactory] n
)n o
)o p
;p q
_apiUrl!! 
=!! 
configuration!! #
?!!# $
[!!$ %
$str!!% -
]!!- .
??!!/ 1
throw!!2 7
new!!8 ;!
ArgumentNullException!!< Q
(!!Q R
nameof!!R X
(!!X Y
configuration!!Y f
)!!f g
)!!g h
;!!h i
if"" 
("" 
string"" 
."" 
IsNullOrWhiteSpace"" )
("") *
_apiUrl""* 1
)""1 2
)""2 3
throw## 
new## 
ArgumentException## +
(##+ ,
$str##, W
,##W X
nameof##Y _
(##_ `
configuration##` m
)##m n
)##n o
;##o p
}$$ 	
public&& 
async&& 
Task&& #
FetchAndStoreShowsAsync&& 1
(&&1 2
)&&2 3
{'' 	
var(( 
client(( 
=(( 
_httpClientFactory(( +
.((+ ,
CreateClient((, 8
(((8 9
)((9 :
;((: ;
client)) 
.)) 
BaseAddress)) 
=))  
new))! $
Uri))% (
())( )
_apiUrl))) 0
)))0 1
;))1 2
HttpResponseMessage++ 
response++  (
;++( )
try,, 
{-- 
response.. 
=.. 
await..  
client..! '
...' (
GetAsync..( 0
(..0 1
$str..1 8
)..8 9
;..9 :
}// 
catch00 
(00  
HttpRequestException00 '
ex00( *
)00* +
{11 
throw22 
new22  
HttpRequestException22 .
(22. /
$str22/ O
,22O P
ex22Q S
)22S T
;22T U
}33 
if55 
(55 
!55 
response55 
.55 
IsSuccessStatusCode55 -
)55- .
{66 
throw77 
new77 %
InvalidOperationException77 3
(773 4
$str774 U
)77U V
;77V W
}88 
var:: 
content:: 
=:: 
await:: 
response::  (
.::( )
Content::) 0
.::0 1
ReadAsStringAsync::1 B
(::B C
)::C D
;::D E
var;; 
showsDto;; 
=;; 
JsonSerializer;; )
.;;) *
Deserialize;;* 5
<;;5 6
List;;6 :
<;;: ;
ShowDto;;; B
>;;B C
>;;C D
(;;D E
content;;E L
,;;L M
new;;N Q!
JsonSerializerOptions;;R g
{;;h i 
PropertyNamingPolicy;;j ~
=	;; Ä
JsonNamingPolicy
;;Å ë
.
;;ë í
	CamelCase
;;í õ
}
;;ú ù
)
;;ù û
;
;;û ü
bool== 
changesMade== 
=== 
false== $
;==$ %
foreach?? 
(?? 
var?? 
showDto??  
in??! #
showsDto??$ ,
)??, -
{@@ 
ifAA 
(AA 
awaitAA 
_showRepositoryAA )
.AA) *
GetShowByIdAsyncAA* :
(AA: ;
showDtoAA; B
.AAB C
IdAAC E
)AAE F
!=AAG I
nullAAJ N
)AAN O
{BB 
continueCC 
;CC 
}DD 
varFF 
showFF 
=FF 
newFF 
ShowFF #
{GG 
IdHH 
=HH 
showDtoHH  
.HH  !
IdHH! #
,HH# $
NameII 
=II 
showDtoII "
.II" #
NameII# '
,II' (
LanguageJJ 
=JJ 
showDtoJJ &
.JJ& '
LanguageJJ' /
,JJ/ 0
GenresKK 
=KK 
newKK  
ListKK! %
<KK% &
GenreKK& +
>KK+ ,
(KK, -
)KK- .
}LL 
;LL 
awaitNN  
AddGenresToShowAsyncNN *
(NN* +
showNN+ /
,NN/ 0
showDtoNN1 8
.NN8 9
GenresNN9 ?
)NN? @
;NN@ A
ifPP 
(PP 
showDtoPP 
.PP 
	ExternalsPP %
!=PP& (
nullPP) -
)PP- .
{QQ 
showRR 
.RR 
	ExternalsRR "
=RR# $
newRR% (
	ExternalsRR) 2
{SS 
ImdbTT 
=TT 
showDtoTT &
.TT& '
	ExternalsTT' 0
.TT0 1
ImdbTT1 5
,TT5 6
TvrageUU 
=UU  
showDtoUU! (
.UU( )
	ExternalsUU) 2
.UU2 3
TvrageUU3 9
,UU9 :
ThetvdbVV 
=VV  !
showDtoVV" )
.VV) *
	ExternalsVV* 3
.VV3 4
ThetvdbVV4 ;
}WW 
;WW 
}XX 
ifZZ 
(ZZ 
showDtoZZ 
.ZZ 
RatingZZ "
!=ZZ# %
nullZZ& *
)ZZ* +
{[[ 
show\\ 
.\\ 
Rating\\ 
=\\  !
new\\" %
Rating\\& ,
{]] 
Average^^ 
=^^  !
showDto^^" )
.^^) *
Rating^^* 0
.^^0 1
Average^^1 8
}__ 
;__ 
}`` 
ifbb 
(bb 
showDtobb 
.bb 
Networkbb #
!=bb$ &
nullbb' +
)bb+ ,
{cc 
showdd 
.dd 
Networkdd  
=dd! "
awaitdd# (#
GetOrCreateNetworkAsyncdd) @
(dd@ A
showDtoddA H
.ddH I
NetworkddI P
)ddP Q
;ddQ R
}ee 
awaitgg 
_showRepositorygg %
.gg% &
AddShowAsyncgg& 2
(gg2 3
showgg3 7
)gg7 8
;gg8 9
changesMadehh 
=hh 
truehh "
;hh" #
}ii 
ifkk 
(kk 
changesMadekk 
)kk 
{ll 
awaitmm 
_showRepositorymm %
.mm% &
SaveChangesAsyncmm& 6
(mm6 7
)mm7 8
;mm8 9
}nn 
}oo 	
publicqq 
asyncqq 
Taskqq 
<qq 
IEnumerableqq %
<qq% &
Showqq& *
>qq* +
>qq+ ,
GetAllShowsAsyncqq- =
(qq= >
)qq> ?
{rr 	
returnss 
awaitss 
_showRepositoryss (
.ss( )
GetAllShowsAsyncss) 9
(ss9 :
)ss: ;
;ss; <
}tt 	
publicvv 
asyncvv 
Taskvv 
<vv 
Showvv 
>vv 
GetShowByIdAsyncvv  0
(vv0 1
intvv1 4
idvv5 7
)vv7 8
{ww 	
returnxx 
awaitxx 
_showRepositoryxx (
.xx( )
GetShowByIdAsyncxx) 9
(xx9 :
idxx: <
)xx< =
;xx= >
}yy 	
public{{ 
async{{ 
Task{{ 
AddShowAsync{{ &
({{& '
Show{{' +
show{{, 0
){{0 1
{|| 	
await}} 
_showRepository}} !
.}}! "
AddShowAsync}}" .
(}}. /
show}}/ 3
)}}3 4
;}}4 5
await~~ 
_showRepository~~ !
.~~! "
SaveChangesAsync~~" 2
(~~2 3
)~~3 4
;~~4 5
} 	
public
ÅÅ 
async
ÅÅ 
Task
ÅÅ 
UpdateShowAsync
ÅÅ )
(
ÅÅ) *
Show
ÅÅ* .
show
ÅÅ/ 3
)
ÅÅ3 4
{
ÇÇ 	
_showRepository
ÉÉ 
.
ÉÉ 

UpdateShow
ÉÉ &
(
ÉÉ& '
show
ÉÉ' +
)
ÉÉ+ ,
;
ÉÉ, -
await
ÑÑ 
_showRepository
ÑÑ !
.
ÑÑ! "
SaveChangesAsync
ÑÑ" 2
(
ÑÑ2 3
)
ÑÑ3 4
;
ÑÑ4 5
}
ÖÖ 	
public
áá 
async
áá 
Task
áá 
DeleteShowAsync
áá )
(
áá) *
int
áá* -
id
áá. 0
)
áá0 1
{
àà 	
var
ââ 
show
ââ 
=
ââ 
await
ââ 
_showRepository
ââ ,
.
ââ, -
GetShowByIdAsync
ââ- =
(
ââ= >
id
ââ> @
)
ââ@ A
;
ââA B
if
ää 
(
ää 
show
ää 
!=
ää 
null
ää 
)
ää 
{
ãã 
_showRepository
åå 
.
åå  

DeleteShow
åå  *
(
åå* +
show
åå+ /
)
åå/ 0
;
åå0 1
await
çç 
_showRepository
çç %
.
çç% &
SaveChangesAsync
çç& 6
(
çç6 7
)
çç7 8
;
çç8 9
}
éé 
}
èè 	
private
ëë 
async
ëë 
Task
ëë "
AddGenresToShowAsync
ëë /
(
ëë/ 0
Show
ëë0 4
show
ëë5 9
,
ëë9 :
List
ëë; ?
<
ëë? @
string
ëë@ F
>
ëëF G
genres
ëëH N
)
ëëN O
{
íí 	
if
ìì 
(
ìì 
genres
ìì 
==
ìì 
null
ìì 
)
ìì 
return
ìì  &
;
ìì& '
foreach
ïï 
(
ïï 
var
ïï 
	genreName
ïï "
in
ïï# %
genres
ïï& ,
)
ïï, -
{
ññ 
if
óó 
(
óó 
string
óó 
.
óó  
IsNullOrWhiteSpace
óó -
(
óó- .
	genreName
óó. 7
)
óó7 8
)
óó8 9
continue
óó: B
;
óóB C
var
ôô 
genre
ôô 
=
ôô 
_context
ôô $
.
ôô$ %
Genres
ôô% +
.
ôô+ ,
Local
ôô, 1
.
ôô1 2
FirstOrDefault
ôô2 @
(
ôô@ A
g
ôôA B
=>
ôôC E
g
ôôF G
.
ôôG H
Name
ôôH L
==
ôôM O
	genreName
ôôP Y
)
ôôY Z
??
öö 
await
öö  %
_context
öö& .
.
öö. /
Genres
öö/ 5
.
öö5 6!
FirstOrDefaultAsync
öö6 I
(
ööI J
g
ööJ K
=>
ööL N
g
ööO P
.
ööP Q
Name
ööQ U
==
ööV X
	genreName
ööY b
)
ööb c
;
ööc d
if
õõ 
(
õõ 
genre
õõ 
==
õõ 
null
õõ !
)
õõ! "
{
úú 
genre
ùù 
=
ùù 
new
ùù 
Genre
ùù  %
{
ùù& '
Name
ùù( ,
=
ùù- .
	genreName
ùù/ 8
}
ùù9 :
;
ùù: ;
_context
ûû 
.
ûû 
Genres
ûû #
.
ûû# $
Add
ûû$ '
(
ûû' (
genre
ûû( -
)
ûû- .
;
ûû. /
}
üü 
show
†† 
.
†† 
Genres
†† 
.
†† 
Add
†† 
(
††  
genre
††  %
)
††% &
;
††& '
}
°° 
}
¢¢ 	
private
§§ 
async
§§ 
Task
§§ 
<
§§ 
Network
§§ "
>
§§" #%
GetOrCreateNetworkAsync
§§$ ;
(
§§; <

NetworkDto
§§< F

networkDto
§§G Q
)
§§Q R
{
•• 	
var
¶¶ 
existingNetwork
¶¶ 
=
¶¶  !
_context
¶¶" *
.
¶¶* +
Networks
¶¶+ 3
.
¶¶3 4
Local
¶¶4 9
.
¶¶9 :
FirstOrDefault
¶¶: H
(
¶¶H I
n
¶¶I J
=>
¶¶K M
n
¶¶N O
.
¶¶O P
Id
¶¶P R
==
¶¶S U

networkDto
¶¶V `
.
¶¶` a
Id
¶¶a c
)
¶¶c d
??
ßß" $
await
ßß% *
_context
ßß+ 3
.
ßß3 4
Networks
ßß4 <
.
ßß< =!
FirstOrDefaultAsync
ßß= P
(
ßßP Q
n
ßßQ R
=>
ßßS U
n
ßßV W
.
ßßW X
Id
ßßX Z
==
ßß[ ]

networkDto
ßß^ h
.
ßßh i
Id
ßßi k
)
ßßk l
;
ßßl m
if
©© 
(
©© 
existingNetwork
©© 
!=
©©  "
null
©©# '
)
©©' (
{
™™ 
return
´´ 
existingNetwork
´´ &
;
´´& '
}
¨¨ 
var
ÆÆ 

newNetwork
ÆÆ 
=
ÆÆ 
new
ÆÆ  
Network
ÆÆ! (
{
ØØ 
Id
∞∞ 
=
∞∞ 

networkDto
∞∞ 
.
∞∞  
Id
∞∞  "
,
∞∞" #
Name
±± 
=
±± 

networkDto
±± !
.
±±! "
Name
±±" &
,
±±& '
Country
≤≤ 
=
≤≤ 

networkDto
≤≤ $
.
≤≤$ %
Country
≤≤% ,
!=
≤≤- /
null
≤≤0 4
?
≤≤5 6
await
≤≤7 <%
GetOrCreateCountryAsync
≤≤= T
(
≤≤T U

networkDto
≤≤U _
.
≤≤_ `
Country
≤≤` g
)
≤≤g h
:
≤≤i j
null
≤≤k o
}
≥≥ 
;
≥≥ 
_context
µµ 
.
µµ 
Networks
µµ 
.
µµ 
Add
µµ !
(
µµ! "

newNetwork
µµ" ,
)
µµ, -
;
µµ- .
return
∂∂ 

newNetwork
∂∂ 
;
∂∂ 
}
∑∑ 	
private
ππ 
async
ππ 
Task
ππ 
<
ππ 
Country
ππ "
>
ππ" #%
GetOrCreateCountryAsync
ππ$ ;
(
ππ; <

CountryDto
ππ< F

countryDto
ππG Q
)
ππQ R
{
∫∫ 	
var
ªª 
existingCountry
ªª 
=
ªª  !
_context
ªª" *
.
ªª* +
	Countries
ªª+ 4
.
ªª4 5
Local
ªª5 :
.
ªª: ;
FirstOrDefault
ªª; I
(
ªªI J
c
ªªJ K
=>
ªªL N
c
ªªO P
.
ªªP Q
Id
ªªQ S
==
ªªT V

countryDto
ªªW a
.
ªªa b
Id
ªªb d
)
ªªd e
??
ºº! #
await
ºº$ )
_context
ºº* 2
.
ºº2 3
	Countries
ºº3 <
.
ºº< =!
FirstOrDefaultAsync
ºº= P
(
ººP Q
c
ººQ R
=>
ººS U
c
ººV W
.
ººW X
Id
ººX Z
==
ºº[ ]

countryDto
ºº^ h
.
ººh i
Id
ººi k
)
ººk l
;
ººl m
if
ææ 
(
ææ 
existingCountry
ææ 
!=
ææ  "
null
ææ# '
)
ææ' (
{
øø 
return
¿¿ 
existingCountry
¿¿ &
;
¿¿& '
}
¡¡ 
var
√√ 
country
√√ 
=
√√ 
new
√√ 
Country
√√ %
{
ƒƒ 
Id
≈≈ 
=
≈≈ 

countryDto
≈≈ 
.
≈≈  
Id
≈≈  "
,
≈≈" #
Code
∆∆ 
=
∆∆ 

countryDto
∆∆ !
.
∆∆! "
Code
∆∆" &
,
∆∆& '
Name
«« 
=
«« 

countryDto
«« !
.
««! "
Name
««" &
,
««& '
Timezone
»» 
=
»» 

countryDto
»» %
.
»»% &
Timezone
»»& .
}
…… 
;
…… 
_context
ÀÀ 
.
ÀÀ 
	Countries
ÀÀ 
.
ÀÀ 
Add
ÀÀ "
(
ÀÀ" #
country
ÀÀ# *
)
ÀÀ* +
;
ÀÀ+ ,
return
ÃÃ 
country
ÃÃ 
;
ÃÃ 
}
ÕÕ 	
}
ŒŒ 
}œœ 